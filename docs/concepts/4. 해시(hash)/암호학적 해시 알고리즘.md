## 암호학적 해시 알고리즘

- 해시값에서 원본 값을 찾는 게 사실상 실행 불가능한 알고리즘
    - 일방향 함수(one-way function)
    - 수학적인 지식이 많이 요구되는 부분
    - 따라서 이미 있는 해시 함수를 주로 사용
- 원본 값을 찾으려면 모든 조합을 모두 시도해봐야 함(무차별 대입 공격)
    - 이상적 목표
    - 암호학적 해시 함수로 분류된 것 중 이미 깨진 것들이 있음
- 보안 분야에서 다양한 용도로 사용

### 암호학적 해시 알고리즘

- 메시지나 파일의 무결성(integrity) 검사
    - 예: 앞에서 든 미러 사이트에서 파일 다운로드하기
- 디지털 서명 생성 및 검증
- 비밀번호 검증
- 작업 증명(proof-of-work, PoW)
    - 블록체인 등에서 서비스 거부 공격(DoS)을 어렵게 만들기 위해
- 일반 해시 알고리즘 대신으로 사용 가능

### 암호학적 해시 알고리즘의 예

| 알고리듬 | 출력 비트 수 |
|----------|----------------|
| HAVAL | 256/224/192/160/128 |
| MD4 | 128 |
| MD5 | 128 |
| RIPEMD | 128 |
| RIPEMD-160 | 160 |
| SHA-1 | 160 |
| SHA-256/224 | 256/224 |
| SHA-512/384 | 512/384 |
| Tiger(2)-192/160/128 | 192/160/128 |
| WHIRLPOOL | 512 |


### 암호학적 해시 알고리즘의 추가 속성

- 역상 저항성(pre-image resistance)
- 제 2 역상 저항성(second pre-image resistance)
- 충돌 저항성(collision resistance)

### 역상 저항성(pre-image resistance)

- 해시값으로부터 원본 데이터를 찾기가 어려워함
    - 즉, 원본 데이터를 같이 저장하지 않는 용도에 적합
    - 예: 비밀번호 저장
- 비보안학적인 해시 함수에서 본 비트패킹은 역상 저항성이 거의 없음
    - 낮은 역상 저항성을 이용하는 게 역상 공격(pre-image attack)
    - 무차별 대입 공격을 통해서만 해시값을 찾을 수 있는 것이 이상적!
- 즉, 해시값으로부터 패턴을 보기 어려워야 함
    - 좋은 알고리즘의 필요성(예: 산사태 효과)
    - 해시값의 길이가 길수록 좋음

### 제 2 역상 저항성(seconde pre-image resistance)

- 똑같은 해시 값이 나오는 다른 입력값을 찾기 어려워함
    - (입력값, 해시값) 쌍을 이미 가지고 있을 때
    - 이 저항성이 낮으면 제2 역상 공격에 취약
- 역상 저항성보다 한 가지 정보가 더 있는 경우
    - 역상 저항성은 해시값만 있음
    - 제 2 역상 저항성은 입력값도 알고 있음

### 충돌 저항성(collision resistance)

- 해시 값이 똑같은 두 입력값을 찾기가 어려워야 함
    - 해시 값도 입력값도 주어지지 않는 경우
    - 이 저항성이 낮으면 충돌 공격에 취약
- 충돌 공격은 역상 공격들 보다 쉬움
    - 이미 MD5와 SHA-1에 대해 실행 가능한 충돌 공격이 발견됨
    - MD5는 일반 컴퓨터로 몇 초면 충분할 정도
    - 모든 암호학적 해시 함수는 생일 공격(birthday attack)이 가능하기 때문
    - 생일 공격은 무차별 대입 공격보다 빠름(이유: 생일 문제)

## 생일 문제

- 회사 직원 수는 20명
- 이 중에 생일이 9월 1일인 직원이 있을 확률은?